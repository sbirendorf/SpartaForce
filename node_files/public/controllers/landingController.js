function contStartLandingTest(){ui.displayMsgRight("Step on the plate.",!1),ui.BtnsEnableControll(["landing","stop"]);var t=[],a=setInterval(function(){if(globals.currentWeight>3){ui.displayMsgRight("Stand Still.",!1),1==$$(".stop-btn").is(":disabled")&&clearInterval(a);var e=weightCalc(a,t);e>3&&setTimeout(function(){startLandingOperator(e)},3e3)}},200)}function weightCalc(t,a){if(a.push(globals.currentWeight),a.length>10){var e=Math.max.apply(null,a),i=Math.min.apply(null,a);if(1>e-i){for(var n=0,l=a.length,s=0;l>s;s++)n+=parseInt(a[s],10);var g=n/l;return clearInterval(t),ui.displayMsgRight("Step off the plate. ",!1),g}a.shift()}}function startLandingOperator(a){var e=setInterval(function(){if(globals.currentWeight<2){var i=new Audio("../horn.mp3");i.play();var n=ui.getSide(globals.landingTestNumber);ui.displayMsgRight("Jump onto the plate, land on your "+n+" foot",!1),ui.displayMsg("Trials Remaining :"+globals.landingTestNumber),startLanding(a),clearInterval(e),t=0,globals.stopChart=!1,startLandingRealTimeChart(),$$("#sway").show(),$$("#scan").hide(),stratLandingTest()}},2500)}function stratLandingTest(){var t=setInterval(function(){globals.currentWeight>5&&(globals.flag=!0,clearInterval(t))},500)}function validateLandingResult(){return!1}function singleLegLandingResult(t){console.log(t);var a=validateLandingResult(t);if(a){var e=new Audio("../error.mp3");e.play()}else{d=new Date,t.side=ui.getSide(globals.landingTestNumber),t.Date=d.yyyymmdd();var i=t.Input.WeightKG;t.WeightKG=ui.convertWeight(t.Input.WeightKG),console.log(t);var t=JSON.stringify(t);localStorage.setItem("Sparta_landing_"+globals.landingTestNumber+"_"+globals.testGUID,t),console.log(localStorage["Sparta_landing_"+globals.landingTestNumber+"_"+globals.testGUID]);jQuery.parseJSON(localStorage["Sparta_landing_"+globals.landingTestNumber+"_"+globals.testGUID]);globals.landingTestNumber--}if(globals.landingTestNumber>0)setTimeout(function(){ui.displayMsgRight("Loading",!1),drawData=!0,startLandingOperator(i)},2500);else{ui.displayMsgRight("",!1);var n=confirm("Test Over! Send data to sparta Trac?");1==n&&sendDataToTrac("landing"),ui.displayMsgRight("",!1),globals.landingTestNumber=globals.initLandingTestNumber}}function landingProgress(t){"protocolinprogress"==t.Status&&1==globals.flag&&(globals.flag=!1,setTimeout(function(){ui.displayMsgRight("Step off the plate.",!1);var t=new Audio("../stop.mp3");t.play(),globals.stopChart=!0},3e3))}function contStartWeightTest(){ui.displayMsgRight("Step on the plate.",!1),ui.BtnsEnableControll([]);var t=[];$$("#temp_div").show(),$$("#cop1_div").hide(),$$(".msg-area2").hide(),$$("#scan").hide();var a=setInterval(function(){if(globals.currentWeight>3){ui.displayMsgRight("Stand Still.",!1);var e=weightCalc(a,t);null==e&&(e=0),$$("#temp_div").empty(),e=ui.convertWeight(e);var i='<button class="stop-weight-btn btn btn-danger" style="width: 120px;margin-top: 95px;" onClick="stopWeightTest();">Stop Weight</button> <button class="stop-weight-btn btn btn-primary" style="width: 120px;margin-top: 95px;" onClick="sendWeightToTrac('+e.toFixed(1)+');">Save Weight</button><br><br>';$$("#temp_div").append("<div class='weight-test'>"+e.toFixed(1)+"</div>"),$$("#temp_div").append(i)}},100)}function stopWeightTest(){$$("#temp_div").empty(),ui.displayMsgRight("",!1),clearInterval(globals.weightTest),ui.BtnsEnableControll(["scan","sway","landing","weight"]),$$("#temp_div").hide(),$$("#cop1_div").show(),$$(".msg-area2").show()}function sendWeightToTrac(t){var a=new Date,e=a.getFullYear(),i=("0"+(a.getMonth()+1)).slice(-2),n=("0"+a.getDate()).slice(-2),l=("0"+a.getMinutes()).substr(-2),s=("0"+a.getHours()).substr(-2);a=e+"-"+i+"-"+n+" "+s+":"+l+":00";var g={Date:a,uid:globals.testGUID,value:t};g=JSON.stringify(g),$$.ajax({type:"POST",url:"/api/post/save_weight",data:{data:g},success:function(){ui.displayMsgRight("Weight saved",!1)},error:function(t){var t=jQuery.parseJSON(t);console.log(t),ui.setMsg("Failed to save weight",!0)}})}